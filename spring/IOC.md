# Spring IOC(Inversion of Control)控制反转

## DI（Dependency Injection）依赖注入

依赖注入是指对象之间的依赖关系；一起协作的其他对象通过构造器参数，工厂方法参数或者由构造函数或工厂方法创建的对象设置属性。容器的作用就是创建相应的Bean并注入对应的依赖关系。过程实质通过直接使用类的构造函数或者服务定位模式反转控制Bean的实例或者其依赖关系的位置。

DI有两种注入方式：构造器注入和Setter设置注入

### 构造器注入

顾名思义构造器注入需要调用有参构造器实现，一个参数代表一个依赖关系；可以用静态工厂方法传参构造Bean。

### Setter设置注入

通过无参构造或者工厂方法完成Bean创建后，相应依赖通过setter方法注入。

ApplicationContext(Spring中BeanFatory的超集)管理的Beans支持这两种注入方式；

Spring开发团队一般主张当实现的应用组件是不可变对象时使用构造器注入并且保证所需依赖不为null；setter注入主要用作为可选的依赖

当Spring容器创建时容器会校验每个bean的配置，但在bean被实际创建之前，bean的值并不会被设置。单例类型的bean和被设置预安装（默认）的bean会在容器创建时与容器同时创建。另外的bean在被需要时创建，相应的依赖被创建和分配。

Bean创建时，spring尽可能迟的设置属性和依赖关系。因为一些配置问题存在（如循环依赖，依赖对象存在问题）将会导致潜在的可见性延迟（Spring创建Bean时才能发现），所以ApplicationContenxt的实现Bean采用提前实例化的单例模式。

注：可以在配置时指定对应的Bean延迟初始化，如果使用注解配置Bean懒加载@Lazy即可（但如果别的Bean依赖懒加载的依赖时，则懒加载无效）